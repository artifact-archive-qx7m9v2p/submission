Loading InferenceData objects...

================================================================================
COMPREHENSIVE MODEL ASSESSMENT AND COMPARISON
================================================================================

--------------------------------------------------------------------------------
PART 1: INDIVIDUAL MODEL ASSESSMENT
--------------------------------------------------------------------------------

### MODEL 1: HIERARCHICAL (Non-centered) ###

Computing LOO-CV...
Computed from 8000 posterior samples and 8 observations log-likelihood matrix.

         Estimate       SE
elpd_loo   -30.73     1.04
p_loo        1.03        -
------

Pareto k diagnostic values:
                         Count   Pct.
(-Inf, 0.70]   (good)        8  100.0%
   (0.70, 1]   (bad)         0    0.0%
   (1, Inf)   (very bad)    0    0.0%


Pareto k diagnostics:
  All k < 0.5 (good): 5/8
  0.5 ≤ k < 0.7 (ok): 3/8
  k ≥ 0.7 (bad): 0/8
  Max k: 0.6342
  Mean k: 0.4606

### MODEL 2: COMPLETE POOLING ###

Computing LOO-CV...
Computed from 4000 posterior samples and 8 observations log-likelihood matrix.

         Estimate       SE
elpd_loo   -30.52     1.12
p_loo        0.64        -
------

Pareto k diagnostic values:
                         Count   Pct.
(-Inf, 0.70]   (good)        8  100.0%
   (0.70, 1]   (bad)         0    0.0%
   (1, Inf)   (very bad)    0    0.0%


Pareto k diagnostics:
  All k < 0.5 (good): 8/8
  0.5 ≤ k < 0.7 (ok): 0/8
  k ≥ 0.7 (bad): 0/8
  Max k: 0.2852
  Mean k: 0.1982

--------------------------------------------------------------------------------
PART 2: MODEL COMPARISON
--------------------------------------------------------------------------------

Comparing models with az.compare()...

                  rank   elpd_loo     p_loo  ...       dse  warning  scale
Complete_Pooling     0 -30.521461  0.641820  ...  0.000000    False    log
Hierarchical         1 -30.732884  1.027548  ...  0.109516    False    log

[2 rows x 9 columns]

### Comparison Summary ###
ΔELPD (Pooled - Hierarchical): 0.00 ± 0.00
Significance threshold (2×SE): 0.00
Is difference significant? False

Model weights (Akaike):
  Hierarchical: 0.0000
  Complete Pooling: 1.0000

Effective parameters (p_loo):
  Hierarchical: 1.03
  Complete Pooling: 0.64
  Difference: 0.39

Comparison table saved to: /workspace/experiments/model_comparison/loo_comparison.csv

--------------------------------------------------------------------------------
PART 3: GENERATING POSTERIOR PREDICTIONS
--------------------------------------------------------------------------------

Extracting posterior parameters...
Hierarchical: Using theta directly, shape=(4, 2000, 8)
Complete pooling: Using mu, shape=(4, 1000)

Generating posterior predictive samples...
Hierarchical: 8000 samples
Pooled: 4000 samples
Generated 8000 hierarchical samples for each of 8 schools
Generated 4000 pooled samples for each of 8 schools

Posterior means:
  Hierarchical: [8.90313673 7.44145385 6.71756683 7.27825336 6.08982441 6.56226298
 8.78929403 7.58963491]
  Complete Pooling: [7.54794772 7.54794772 7.54794772 7.54794772 7.54794772 7.54794772
 7.54794772 7.54794772]
  Observed: [28  8 -3  7 -1  1 18 12]

--------------------------------------------------------------------------------
PART 4: CALIBRATION ASSESSMENT
--------------------------------------------------------------------------------

Adding posterior predictive samples to InferenceData for LOO-PIT...
Traceback (most recent call last):
  File "/workspace/experiments/model_comparison/code/comprehensive_assessment.py", line 210, in <module>
    idata_hierarchical.add_groups({
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
        'posterior_predictive': {
        ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        }
        ^
    })
    ^^
  File "/app/backend-v2/.venv/lib/python3.13/site-packages/arviz/data/inference_data.py", line 1589, in add_groups
    dataset = dict_to_dataset(dataset, coords=coords, dims=dims)
  File "/app/backend-v2/.venv/lib/python3.13/site-packages/arviz/data/base.py", line 406, in dict_to_dataset
    key: numpy_to_data_array(
         ~~~~~~~~~~~~~~~~~~~^
        values,
        ^^^^^^^
    ...<5 lines>...
        skip_event_dims=skip_event_dims,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/app/backend-v2/.venv/lib/python3.13/site-packages/arviz/data/base.py", line 269, in numpy_to_data_array
    ary = utils.two_de(ary)
  File "/app/backend-v2/.venv/lib/python3.13/site-packages/arviz/utils.py", line 398, in two_de
    return np.atleast_2d(x)
           ~~~~~~~~~~~~~^^^
  File "/app/backend-v2/.venv/lib/python3.13/site-packages/numpy/_core/shape_base.py", line 121, in atleast_2d
    ary = asanyarray(ary)
ValueError: setting an array element with a sequence. The requested array has an inhomogeneous shape after 1 dimensions. The detected shape was (2,) + inhomogeneous part.
