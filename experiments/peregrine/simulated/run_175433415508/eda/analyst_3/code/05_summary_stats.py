"""
Summary Statistics and Key Findings
Quick reference for main results
"""

import pandas as pd
import numpy as np

# Load data
data = pd.read_csv('/workspace/data/data_analyst_3.csv')
results = np.load('/workspace/eda/analyst_3/code/model_results.npz')

print("="*80)
print("EDA ANALYST 3 - SUMMARY OF KEY FINDINGS")
print("="*80)
print()
print("DATASET CHARACTERISTICS")
print("-"*80)
print(f"Sample size: {len(data)}")
print(f"Time range (standardized): [{data['year'].min():.2f}, {data['year'].max():.2f}]")
print(f"Count range: [{data['C'].min()}, {data['C'].max()}]")
print(f"Missing values: {data.isnull().sum().sum()}")
print()

print("CRITICAL FINDINGS")
print("-"*80)
print(f"1. OVERDISPERSION: Variance/Mean = {data['C'].var() / data['C'].mean():.2f}")
print(f"   → Poisson REJECTED (p < 0.001)")
print(f"   → Negative Binomial REQUIRED")
print()
print(f"2. AUTOCORRELATION: Lag-1 = {np.corrcoef(data['C'][:-1], data['C'][1:])[0,1]:.3f}")
print(f"   → Very strong temporal dependence")
print(f"   → Need correlated error structure (GEE/GLMM)")
print()
print(f"3. HETEROSCEDASTICITY:")
print(f"   - Linear model: p = {results['bp_pvalue_linear']:.3f} (Homoscedastic ✓)")
print(f"   - Log model: p = {results['bp_pvalue_log']:.3f} (Heteroscedastic ✗)")
print(f"   - Sqrt model: p = {results['bp_pvalue_sqrt']:.3f} (Heteroscedastic ✗)")
print()
print(f"4. MODEL FIT (R²):")
print(f"   - Linear: {results['r2_linear']:.4f}")
print(f"   - Log: {results['r2_log']:.4f} (best fit)")
print(f"   - Sqrt: {results['r2_sqrt']:.4f}")
print()

print("RECOMMENDED MODELS")
print("-"*80)
print("1. NEGATIVE BINOMIAL REGRESSION (primary)")
print("   log(μ) = β₀ + β₁×year")
print("   - Handles overdispersion naturally")
print("   - Add AR(1) correlation structure")
print()
print("2. QUASI-POISSON (alternative)")
print("   - Simpler, adjusts SEs for overdispersion")
print()
print("3. GAUSSIAN GLM with log link + robust SEs (fallback)")
print()

print("NOT RECOMMENDED")
print("-"*80)
print("✗ Standard Poisson (equidispersion violated)")
print("✗ Simple linear regression (count data constraints)")
print()

print("OUTPUT FILES")
print("-"*80)
print("Visualizations (5 files, 300 dpi):")
print("  - residual_diagnostics_all_models.png")
print("  - variance_mean_relationship.png")
print("  - dispersion_analysis.png")
print("  - transformation_comparison.png")
print("  - influence_diagnostics.png")
print()
print("Code (5 scripts):")
print("  - 01_initial_exploration.py")
print("  - 02_residual_diagnostics.py")
print("  - 03_visualizations.py")
print("  - 04_count_model_tests.py")
print("  - 05_summary_stats.py (this file)")
print()
print("Reports:")
print("  - findings.md (comprehensive report)")
print("  - eda_log.md (detailed exploration log)")
print()
print("="*80)
print("All outputs saved to: /workspace/eda/analyst_3/")
print("="*80)
