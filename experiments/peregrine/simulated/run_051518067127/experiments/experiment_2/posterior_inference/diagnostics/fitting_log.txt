WARNING (pytensor.configdefaults): g++ not detected!  PyTensor will be unable to compile C-implementations and will default to Python. Performance may be severely degraded. To remove this warning, set PyTensor flags cxx to an empty string.
================================================================================
FITTING AR(1) LOG-NORMAL MODEL WITH REGIME-SWITCHING TO REAL DATA
================================================================================

[1/7] Loading data...
  Loaded 40 observations
  Year range: [-1.668, 1.668]
  C range: [21, 269]
  Regime structure: 40 observations
    Regime 1 (early): 14 obs
    Regime 2 (middle): 13 obs
    Regime 3 (late): 13 obs
  Data ACF lag-1 (log-scale): 0.9749

[2/7] Building PyMC model (vectorized)...
  Model built successfully
  Free parameters: 6

[3/7] Fitting model with MCMC...
  Strategy: Adaptive sampling
    Phase 1: Short probe (200 iterations) to diagnose
    Phase 2: Main sampling if probe succeeds

  Phase 1: Diagnostic probe...
Initializing NUTS using jitter+adapt_diag...
/tmp/agent-home/.local/lib/python3.13/site-packages/pytensor/tensor/rewriting/elemwise.py:887: UserWarning: Loop fusion failed because the resulting node would exceed the kernel argument limit.
  warn(
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [alpha, beta_1, beta_2, phi_raw, sigma_regime, epsilon_0]
                                                                                
                              Step      Grad      Sampli…                       
  Progre…   Draws   Diverg…   size      evals     Speed     Elapsed   Remaini…  
 ────────────────────────────────────────────────────────────────────────────── 
  ━━━━━━━   500     0         0.364     15        25.16     0:00:19   0:00:00   
                                                  draws/s                       
  ━━━━━━━   500     0         0.388     15        26.05     0:00:19   0:00:00   
                                                  draws/s                       
  ━━━━━━━   500     0         0.287     15        24.82     0:00:20   0:00:00   
                                                  draws/s                       
  ━━━━━━━   500     0         0.208     15        26.29     0:00:18   0:00:00   
                                                  draws/s                       
                                                                                
Sampling 4 chains for 300 tune and 200 draw iterations (1_200 + 800 draws total) took 20 seconds.
The rhat statistic is larger than 1.01 for some parameters. This indicates problems during sampling. See https://arxiv.org/abs/1903.08008 for details
    Probe results: max R-hat = 1.0000, min ESS = 454
    Probe successful - proceeding to main sampling
    Divergences in probe: 0

  Phase 2: Main sampling...
    Using standard settings (target_accept=0.90)
Initializing NUTS using jitter+adapt_diag...
/tmp/agent-home/.local/lib/python3.13/site-packages/pytensor/tensor/rewriting/elemwise.py:887: UserWarning: Loop fusion failed because the resulting node would exceed the kernel argument limit.
  warn(
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [alpha, beta_1, beta_2, phi_raw, sigma_regime, epsilon_0]
                                                                                
                              Step      Grad      Sampli…                       
  Progre…   Draws   Diverg…   size      evals     Speed     Elapsed   Remaini…  
 ────────────────────────────────────────────────────────────────────────────── 
  ━━━━━━━   3500    0         0.318     7         31.56     0:01:50   0:00:00   
                                                  draws/s                       
  ━━━━━━━   3500    0         0.291     7         31.72     0:01:50   0:00:00   
                                                  draws/s                       
  ━━━━━━━   3500    0         0.348     15        30.71     0:01:53   0:00:00   
                                                  draws/s                       
  ━━━━━━━   3500    0         0.310     15        31.43     0:01:51   0:00:00   
                                                  draws/s                       
                                                                                
Sampling 4 chains for 1_500 tune and 2_000 draw iterations (6_000 + 8_000 draws total) took 114 seconds.
  Sampling complete!

[4/7] Performing convergence diagnostics...

  Parameter Summary:
Traceback (most recent call last):
  File "/workspace/experiments/experiment_2/posterior_inference/code/fit_model.py", line 160, in <module>
    print(summary_params[['mean', 'sd', 'hdi_5%', 'hdi_95%', 'r_hat', 'ess_bulk', 'ess_tail']])
          ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp/agent-home/.local/lib/python3.13/site-packages/pandas/core/frame.py", line 4119, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/tmp/agent-home/.local/lib/python3.13/site-packages/pandas/core/indexes/base.py", line 6212, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp/agent-home/.local/lib/python3.13/site-packages/pandas/core/indexes/base.py", line 6264, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['hdi_5%', 'hdi_95%'] not in index"
